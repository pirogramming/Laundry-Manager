// static/laundry_manager/main-script.js

import { animate, scroll, stagger } from "https://cdn.jsdelivr.net/npm/motion@latest/+esm";

// --- í˜ì´ì§€ ë¡œë“œ ì• ë‹ˆë©”ì´ì…˜ ---
animate(
    ".mobile-container",
    { opacity: [0, 1] },
    { duration: 0.5, easing: "ease-out" }
);

// --- Swiper.js ìºëŸ¬ì…€ ì´ˆê¸°í™” ---
const swiper = new Swiper('.main-swiper', {
    slidesPerView: 1,
    spaceBetween: 12,
    loop: true,
    autoplay: {
        delay: 3000,
        disableOnInteraction: false,
    },
    pagination: {
        el: '.swiper-pagination',
        clickable: true,
    },
});

// --- ëª¨ë“  ë²„íŠ¼ì— ëŒ€í•œ ì¸í„°ë™ì…˜ í”¼ë“œë°± ---
const buttons = document.querySelectorAll('button, a.cta-button, a.nav-item ');
buttons.forEach(button => {
    button.addEventListener('pointerdown', () => {
        animate(button, { scale: 0.97 }, { duration: 0.1 });
    });
    ['pointerup', 'pointerleave'].forEach(eventName => {
        button.addEventListener(eventName, () => {
            animate(button, { scale: 1 }, { duration: 0.1 });
        });
    });
});

// --- 'ê¸°ë¡ ë³´ê¸°' ëª©ë¡ì´ ìˆœì°¨ì ìœ¼ë¡œ ë‚˜íƒ€ë‚˜ëŠ” íš¨ê³¼ ---
animate(
    ".history-item",
    { 
        opacity: [0, 1],
        y: [15, 0]
    },
    { 
        delay: stagger(0.1, { start: 0.5 }) 
    }
);

// --- ì˜¤ëŠ˜ì˜ ìš´ì„¸ íŒì—… ê¸°ëŠ¥ ---
const fortuneModal = document.getElementById('fortune-modal');

const fortunes = [
    "ë§ˆìŒì† ê¹Šì´ ê°„ì§í•´ ì˜¨ ì°½ì¡°ì ì¸ ë¶ˆê½ƒì´ ë“œë””ì–´ ì›…ì¥í•œ ë‚ ê°¯ì§“ì„ ì‹œì‘í•  ê²ƒì…ë‹ˆë‹¤. ì˜ˆìƒì¹˜ ëª»í•œ ê³³ì—ì„œ ì˜ê°ì´ ìƒ˜ì†Ÿê³ , ë¬µí˜€ë‘ì—ˆë˜ ê³„íšë“¤ì´ ë†€ë¼ìš´ ì†ë„ë¡œ í˜„ì‹¤í™”ë  í•˜ë£¨ì…ë‹ˆë‹¤.",
    "ì˜¤ëŠ˜ì€ í‰ë²”í•œ ì¼ìƒ ì†ì—ì„œ ë¹„ë²”í•œ ê¸°ì¨ì„ ë°œê²¬í•˜ëŠ” ë‚ ì…ë‹ˆë‹¤. ìŠ¤ì³ ì§€ë‚˜ê°€ëŠ” ë°”ëŒ, ë”°ëœ»í•œ ì»¤í”¼ í•œ ì”ì—ì„œë„ ì‚¶ì˜ ì†Œì¤‘í•œ ì˜ë¯¸ë¥¼ ê¹¨ë‹«ê²Œ ë  ê²ƒì…ë‹ˆë‹¤. ê°ì„±ì„ ì—´ì–´ë‘ì„¸ìš”.",
    "ê°•ë ¥í•œ ë¦¬ë”ì‹­ì´ ë°œíœ˜ë˜ëŠ” ë‚ ì…ë‹ˆë‹¤. ë§ì„¤ì´ì§€ ë§ê³  ë‹¹ì‹ ì˜ ë¹„ì „ì„ ëª…í™•í•˜ê²Œ ì œì‹œí•˜ì„¸ìš”. ë‹¹ì‹ ì˜ í™•ì‹ ì— ì°¬ ì–¸ì–´ëŠ” ì£¼ë³€ ì‚¬ëŒë“¤ì—ê²Œ ê¹Šì€ ì‹ ë¢°ë¥¼ ì£¼ì–´ í•˜ë‚˜ì˜ ëª©í‘œë¡œ ì´ëŒ ê²ƒì…ë‹ˆë‹¤.",
    "ì˜¤ë«ë™ì•ˆ ì—°ë½ì´ ëŠê²¼ë˜ ì†Œì¤‘í•œ ì¸ì—°ìœ¼ë¡œë¶€í„° ë°˜ê°€ìš´ ì†Œì‹ì´ ì°¾ì•„ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë§ˆìŒì„ ì—´ê³  ë¨¼ì € ë‹¤ê°€ê°€ ë³´ì„¸ìš”. ë”°ëœ»í•œ ëŒ€í™”ê°€ ìƒˆë¡œìš´ ê¸°íšŒì˜ ë¬¸ì„ ì—´ì–´ì¤„ ê²ƒì…ë‹ˆë‹¤.",
    "ë…¼ë¦¬ì ì¸ ë¶„ì„ì„ ë„˜ì–´ì„  ì˜ˆë¦¬í•œ ì§ê´€ì´ ë‹¹ì‹ ì„ ì„±ê³µì˜ ì§€ë¦„ê¸¸ë¡œ ì•ˆë‚´í•  ê²ƒì…ë‹ˆë‹¤. ì¤‘ìš”í•œ ê²°ì •ì„ ì•ë‘ê³  ìˆë‹¤ë©´, ì˜¤ëŠ˜ì€ ë‹¹ì‹ ì˜ ì²« ëŠë‚Œì„ ë¯¿ì–´ë³´ì„¸ìš”.",
    "ì‘ì€ ì¹œì ˆì´ ì˜ˆìƒì¹˜ ëª»í•œ í° í–‰ìš´ìœ¼ë¡œ ëŒì•„ì˜¤ëŠ” í•˜ë£¨ì…ë‹ˆë‹¤. ë„ì›€ì´ í•„ìš”í•œ ì‚¬ëŒì—ê²Œ ë”°ëœ»í•œ ì†ê¸¸ì„ ë‚´ë¯¸ëŠ” ê²ƒì„ ë§ì„¤ì´ì§€ ë§ˆì„¸ìš”. ê·¸ ì„ í–‰ì´ ë‹¹ì‹ ì˜ ê¸¸ì„ ë°í˜€ì¤„ ê²ƒì…ë‹ˆë‹¤.",
    "ì˜¤ëŠ˜ì€ ìƒˆë¡œìš´ ì§€ì‹ê³¼ ê¸°ìˆ ì„ ìŠ¤í€ì§€ì²˜ëŸ¼ í¡ìˆ˜í•˜ëŠ” ë‚ ì…ë‹ˆë‹¤. í‰ì†Œ ê´€ì‹¬ ìˆë˜ ë¶„ì•¼ì˜ ì±…ì„ ì½ê±°ë‚˜ ì§§ì€ ê°•ì˜ë¥¼ ë“¤ì–´ë³´ì„¸ìš”. ì˜¤ëŠ˜ì˜ ë°°ì›€ì´ ë¯¸ë˜ì˜ ë‹¹ì‹ ì—ê²Œ í° ìì‚°ì´ ë  ê²ƒì…ë‹ˆë‹¤.",
    "ë‹¹ì‹ ì˜ ì„¬ì„¸í•œ ê°ê°ê³¼ ê¾¸ì¤€í•œ ë…¸ë ¥ì´ ë§ˆì¹¨ë‚´ ë¹›ì„ ë°œí•˜ëŠ” ë‚ ì…ë‹ˆë‹¤. ì˜¤ë«ë™ì•ˆ ê³µë“¤ì—¬ì˜¨ í”„ë¡œì íŠ¸ë‚˜ ì‘í’ˆì´ ìˆë‹¤ë©´, ì˜¤ëŠ˜ ì£¼ë³€ì— ê³µê°œí•´ë³´ì„¸ìš”. ê¸°ëŒ€ ì´ìƒì˜ ì°¬ì‚¬ë¥¼ ë°›ê²Œ ë  ê²ƒì…ë‹ˆë‹¤.",
    "ì˜¤ëŠ˜ì€ ì‚¬ì†Œí•œ ìš°ì—°ì´ ë‹¹ì‹ ì„ íŠ¹ë³„í•œ ê¸¸ë¡œ ì¸ë„í•  ê²ƒì…ë‹ˆë‹¤. ë¬´ì‹¬ì½” ê±´ë„¨ ë¯¸ì†Œ, ìš°ì—°íˆ ê±´ë„Œ ë°œê±¸ìŒì´ ì˜ˆìƒì¹˜ ëª»í•œ í–‰ìš´ì˜ ì‹œì‘ì ì´ ë©ë‹ˆë‹¤.",
    "ì–´ì œì˜ ë¶ˆì•ˆì€ ì‚¬ë¼ì§€ê³ , ì˜¤ëŠ˜ì€ í¬ë§ì´ ê°€ë“ ì°¨ì˜¤ë¥´ëŠ” ë‚ ì…ë‹ˆë‹¤. ìì‹ ì„ ë¯¿ê³  í•œ ê±¸ìŒ ë” ë‚´ë”›ëŠ” ìˆœê°„, ë‹«í˜€ ìˆë˜ ë¬¸ì´ ì—´ë¦´ ê²ƒì…ë‹ˆë‹¤.",
    "ì˜¤ëŠ˜ì€ ë‹¹ì‹ ì˜ ë§ í•œë§ˆë””ê°€ ëˆ„êµ°ê°€ì˜ í•˜ë£¨ë¥¼ ë°íˆëŠ” ë“±ë¶ˆì´ ë©ë‹ˆë‹¤. ê¸ì •ì ì¸ ì–¸ì–´ë¥¼ ì„ íƒí•˜ì„¸ìš”. ê·¸ê²ƒì´ ê³§ ë‹¹ì‹ ì—ê²Œë„ ëŒì•„ì˜µë‹ˆë‹¤.",
    "ì‘ì€ ë„ì „ì´ í° ì„±ì·¨ë¡œ ì´ì–´ì§€ëŠ” í•˜ë£¨ì…ë‹ˆë‹¤. ë§ì„¤ì´ì§€ ë§ê³  ìƒˆë¡œìš´ ì‹œë„ë¥¼ í•´ë³´ì„¸ìš”. ìƒê°ë³´ë‹¤ í›¨ì”¬ ì‰½ê²Œ ê¸¸ì´ ì—´ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
    "ë‹¹ì‹ ì˜ ì§„ì‹¬ ì–´ë¦° ë°°ë ¤ê°€ ì£¼ë³€ ì‚¬ëŒë“¤ì˜ ë§ˆìŒì„ ê¹Šì´ ìš¸ë¦´ ê²ƒì…ë‹ˆë‹¤. ê·¸ ë”°ëœ»í•¨ì´ ëŒê³  ëŒì•„ ì˜¤ëŠ˜ì„ íŠ¹ë³„í•˜ê²Œ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤.",
    "ì˜¤ëŠ˜ì€ ê³¼ê±°ì˜ ìƒì²˜ê°€ ì¹˜ìœ ë˜ëŠ” ë‚ ì…ë‹ˆë‹¤. ì˜¤ë˜ ë¬µí˜€ë‘” ê°ì •ì„ ì •ë¦¬í•˜ê³  ë‚˜ë©´, í›¨ì”¬ ê°€ë²¼ìš´ ë§ˆìŒìœ¼ë¡œ ìƒˆë¡œìš´ ê¸¸ì„ ê±¸ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
    "ì˜ˆìƒì¹˜ ëª»í•œ ê¸°íšŒê°€ ì†ì„ ë‚´ë°€ì–´ ì˜µë‹ˆë‹¤. ê·¸ê²ƒì´ ì‘ì•„ ë³´ì¼ì§€ë¼ë„ ì¡ì•„ë³´ì„¸ìš”. ê·¸ ì‘ì€ ì‹œì‘ì´ í° ë¯¸ë˜ë¡œ í™•ì¥ë©ë‹ˆë‹¤.",
    "ìì—°ì˜ ë¦¬ë“¬ê³¼ í•¨ê»˜ ì¡°í™”ë¥¼ ì´ë£¨ëŠ” ë‚ ì…ë‹ˆë‹¤. ë°”ëŒ, í–‡ì‚´, ì‘ì€ ìƒˆì†Œë¦¬ì— ê·€ ê¸°ìš¸ì—¬ ë³´ì„¸ìš”. ë‹¹ì‹ ì˜ ë§ˆìŒë„ ê³ ìš”í•˜ê²Œ ì •ëˆë  ê²ƒì…ë‹ˆë‹¤.",
    "ì˜¤ëŠ˜ì€ í‰ì†Œ ê°„ê³¼í–ˆë˜ ëŠ¥ë ¥ì´ ìŠ¤ìŠ¤ë¡œ ë“œëŸ¬ë‚˜ëŠ” ìˆœê°„ì„ ê²½í—˜í•©ë‹ˆë‹¤. ìì‹ ì´ ëª°ëë˜ ê°€ëŠ¥ì„±ì„ ë¯¿ê³  ìƒˆë¡œìš´ ìë¶€ì‹¬ì„ ëŠê»´ë³´ì„¸ìš”.",
    "ë‹¹ì‹ ì˜ ì›ƒìŒì†Œë¦¬ê°€ í–‰ìš´ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ìì„ì´ ë˜ëŠ” ë‚ ì…ë‹ˆë‹¤. ì¦ê±°ìš´ ë§ˆìŒìœ¼ë¡œ í•˜ë£¨ë¥¼ ë§ì´í•˜ë©´, ì¢‹ì€ ì†Œì‹ì´ ì¤„ì¤„ì´ ë”°ë¼ì˜¬ ê²ƒì…ë‹ˆë‹¤."
];

// fortuneModalì´ HTMLì— ì‹¤ì œë¡œ ì¡´ì¬í•  ê²½ìš°ì—ë§Œ ì•„ë˜ ë¡œì§ì„ ì‹¤í–‰í•©ë‹ˆë‹¤. (ì˜¤ë¥˜ ë°©ì§€)
if (fortuneModal) {
    const closeModalBtn = document.getElementById('close-modal-btn');
    const dontShowAgainBtn = document.getElementById('dont-show-again-btn');
    const fortuneTextElement = fortuneModal.querySelector('.fortune-text');

    // ğŸ‘‡ 1. HTMLì˜ body íƒœê·¸ì—ì„œ ì‚¬ìš©ì IDë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
    const userId = document.body.dataset.userId || 'guest';
    
    // ğŸ‘‡ 2. ê° ì‚¬ìš©ìë¥¼ ìœ„í•œ ê³ ìœ í•œ localStorage í‚¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
    const storageKey = `hideFortuneForToday_${userId}`;

    // ğŸ‘‡ 3. ê³ ìœ  í‚¤ë¥¼ ì‚¬ìš©í•˜ì—¬ íŒì—…ì„ ë³´ì—¬ì¤„ì§€ ê²°ì •í•©ë‹ˆë‹¤.
    if (!localStorage.getItem(storageKey)) {
        
        // ìš´ì„¸ ëª©ë¡ì—ì„œ ëœë¤ìœ¼ë¡œ í•˜ë‚˜ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
        const randomIndex = Math.floor(Math.random() * fortunes.length);
        const randomFortune = fortunes[randomIndex];

        // ì„ íƒëœ ìš´ì„¸ë¥¼ íŒì—…ì˜ p íƒœê·¸ ì•ˆì— ì±„ì›Œ ë„£ìŠµë‹ˆë‹¤.
        if (fortuneTextElement) {
            fortuneTextElement.textContent = randomFortune;
        }
        
        // íŒì—…ì„ í™”ë©´ì— í‘œì‹œí•©ë‹ˆë‹¤.
        fortuneModal.classList.add('visible');
    }

    // 'ë‹«ê¸°' ë²„íŠ¼ ì´ë²¤íŠ¸
    closeModalBtn.addEventListener('click', () => {
        fortuneModal.classList.remove('visible');
    });

    // 'ì˜¤ëŠ˜ í•˜ë£¨ ë³´ì§€ ì•Šê¸°' ë²„íŠ¼ ì´ë²¤íŠ¸
    dontShowAgainBtn.addEventListener('click', () => {
        // ğŸ‘‡ 4. ê³ ìœ  í‚¤(storageKey)ì— ê°’ì„ ì €ì¥í•©ë‹ˆë‹¤.
        localStorage.setItem(storageKey, 'true');
        fortuneModal.classList.remove('visible');
    });
}