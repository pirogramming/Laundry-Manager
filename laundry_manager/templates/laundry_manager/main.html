<!DOCTYPE html>
<html lang="ko">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>세탁 매니저 - 메인</title>

    <!-- 외부 CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">
    <link rel="stylesheet" href="{% static 'laundry_manager/main-style2.css' %}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

    <!-- (임시) 오늘의 운세 모달 전용 스타일: 필요시 main-style2.css로 이동 -->
    <style>
      .fortune-backdrop{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;
        background:rgba(0,0,0,.35);z-index:9999}
      .fortune-modal{background:#fff;border-radius:16px;max-width:360px;width:92%;
        box-shadow:0 10px 30px rgba(0,0,0,.2);overflow:hidden}
      .fortune-header{display:flex;align-items:center;justify-content:space-between;
        padding:12px 16px;border-bottom:1px solid #eee}
      .fortune-body{padding:16px;line-height:1.6}
      .fortune-close{background:none;border:none;font-size:24px;cursor:pointer;line-height:1}
      /* 접근성 대비 포커스 */
      .fortune-close:focus{outline:2px solid #333; outline-offset:2px}
      /* 모션은 나중에 JS 붙일 때 켤 수 있음 */
    </style>
</head>
<body>
<div class="mobile-container">
    <header class="greeting-section">
        <div class="logo-and-title">
            <div class="logo-area">
                <img src="{% static 'stain_image/laundry-manager-logo.svg' %}" alt="세탁 매니저 로고" class="laundry-logo">
            </div>
            <div class="title-group">
                {# 필요 시 제목/설명 노출 #}
                {# <span class="logo-exp">생활형 세탁 정보 추천 플랫폼</span> #}
                {# <h2>세탁매니저</h2> #}
            </div>
        </div>

        <div class="profile-and-greeting">
            {% comment %} <a href="{% url 'login' %}" class="profile-link" aria-label="프로필 / 로그인">
                <img
                    src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxMSEhMT..."  <!-- 생략 -->
                    alt="프로필 사진"
                    class="profile-pic">
            </a> {% endcomment %}
            <div class="greeting-text">
                <p>안녕하세요👋</p>
                <h2>
                    {% if user.is_authenticated %}
                        <span class="username">{{ display_name }}</span>님
                    {% else %}
                        <span class="username">방문자</span>님
                    {% endif %}
                </h2>
            </div>
        </div>
    </header>

    <main>
        <!-- CTA: 세탁 정보 입력 (한 번만 노출) -->
        <section class="cta-card">
            <div class="cta-icon-wrapper">
                <i class="fa-solid fa-shirt"></i>
            </div>
            <div class="cta-text">
                <h3 class="cta-title">세탁 정보 입력</h3>
                <p>세탁 라벨을 인식해 정확한 세탁 방법을 알려드려요!</p>
            </div>
            <a href="{% url 'laundry-upload' %}" class="cta-button" id="takePictureBtn">
                사진 찍고 세탁법 받기
                <i class="fa-solid fa-play" aria-hidden="true"></i>
            </a>
        </section>

        <!-- 오늘의 세탁법 -->
        <h3 class="main-title">
            <span>오늘의 세탁법</span>
            <a href="{% url 'dictionary' %}" class="carousel-more">
                더보기 <i class="fa-solid fa-arrow-right" aria-hidden="true"></i>
            </a>
        </h3>

        <section class="main-carousel-section">
            <div class="swiper main-swiper">
                <div class="swiper-wrapper">
                        <div class="swiper-slide" style="background-image:url(https://cdnweb01.wikitree.co.kr/webdata/editor/202311/07/img_20231107151039_0782a7df.webp)">
                            <a href="{% url 'dictionary_detail' item_title='흰 옷에서 얼룩을 제거하는 방법'|urlencode %}">
                                <div class="slide-content">
                                    <h4>흰 옷에서 얼룩을 제거하는 방법</h4>
                                    <p>얼룩 묻은 흰 옷을 효과적으로 세탁하세요!</p>
                                </div>
                            </a>
                        </div>
                    <div class="swiper-slide" style="background-image:url(https://cdn.pixabay.com/photo/2015/10/06/13/53/bears-974462_1280.jpg)">
                        <a href="{% url 'dictionary_detail' item_title='니트 보관 방법'|urlencode %}" class="info-grid-item">
                            <div class="slide-content">
                                <h4>니트 보관 법</h4>

                                <p>줄어들 걱정 없이 깨끗하게 세탁하세요</p>
                            </div>
                        </a>
                    </div>

                    <div class="swiper-slide" style="background-image:url(https://pds.joongang.co.kr//news/component/htmlphoto_mmdata/201805/25/c8c555ac-09fe-4224-9231-316645f7aded.jpg)">
                        <a href="{% url 'dictionary_detail' item_title='면 옷의 얼룩 제거법'|urlencode %}" class="info-grid-item">
                            <div class="slide-content">
                                <h4>면 옷의 얼룩 제거법</h4>
                                <p>김칫자국부터 커피 얼룩까지 완벽 제거</p>
                            </div>
                        </a>
                    </div>
                </div>
                <div class="swiper-pagination"></div>
            </div>
        </section>

        <!-- 기록보기 -->
        <section class="history-section">
            <h3>기록보기</h3>
            <div class="history-list">
                {% for record in records %}
                    <a href="{% url 'laundry_history_detail' record.pk %}" class="history-item">
                        <img src="{{ record.get_stain_image_url }}" alt="{{ record.stains }}" class="history-img">
                        <div class="history-details">
                            <h4>{{ record.materials }} / {{ record.stains }} 제거</h4>
                            <p>{{ record.created_at|timesince }} 전 검색</p>
                        </div>
                        <i class="fa-solid fa-chevron-right" aria-hidden="true"></i>
                    </a>
                {% empty %}
                    <p>아직 기록이 없습니다.</p>
                {% endfor %}
            </div>
        </section>
    </main>

    <!-- 하단 내비게이션 -->
    <nav class="bottom-nav" aria-label="하단 내비게이션">
        <a href="{% url 'main' %}" class="nav-item active">
            <i class="fa-solid fa-house" aria-hidden="true"></i>
            <span>메인 화면</span>
        </a>
        <a href="{% url 'map' %}" class="nav-item">
            <i class="fa-solid fa-map-location-dot" aria-hidden="true"></i>
            <span>지도</span>
        </a>
        <a href="{% url 'laundry-upload' %}" class="nav-item-main" aria-label="사진 찍기">
            <i class="fa-solid fa-camera" aria-hidden="true"></i>
        </a>
        <a href="{% url 'dictionary' %}" class="nav-item">
            <i class="fa-solid fa-book-open" aria-hidden="true"></i>
            <span>백과사전</span>
        </a>
        <a href="{% url 'profile' %}" class="nav-item">
            <i class="fa-solid fa-gear" aria-hidden="true"></i>
            <span>더보기</span>
        </a>
    </nav>
</div>

<!-- 오늘의 운세 모달 (JS 붙기 전, 기본 hidden) -->
    {% comment %} <div id="fortune-modal" class="fortune-backdrop" hidden>
    <div class="fortune-modal" role="dialog" aria-modal="true" aria-labelledby="fortune-title">
        <div class="fortune-header">
        <strong id="fortune-title">오늘의 운세</strong>
        <button id="fortune-close" class="fortune-close" type="button" aria-label="닫기">&times;</button>

        </div>
        <div class="fortune-body">
        <p id="fortune-text">로딩 대기 중…</p>
        </div>
    </div>
    </div> {% endcomment %}

<!-- 스크립트 (기존만 유지, 운세 JS는 보류) -->
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/motion@latest/dist/motion.js"></script>
<script type="module" src="{% static 'laundry_manager/main-script2.js' %}"></script>
<script>
  /* Swiper가 main-script2.js에서 초기화되지 않는 경우를 대비한 안전 초기화 */
  window.addEventListener('DOMContentLoaded', () => {
      if (typeof Swiper !== 'undefined') {
          new Swiper('.main-swiper', {
              pagination: { el: '.swiper-pagination', clickable: true },
              loop: true
          });
      }
  });
</script>
</body>
</html>
